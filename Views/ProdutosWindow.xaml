<Window x:Class="WpfApp.Views.ProdutosWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:xctk="http://schemas.xceed.com/wpf/xaml/toolkit"
        Title="Cadastro de Produtos" Height="620" Width="960"
        WindowStartupLocation="CenterScreen"
        Background="#FFF5F5F5">

    <Window.Resources>
        <Style x:Key="ModernGroupBox" TargetType="GroupBox">
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="16"/>
            <Setter Property="Margin" Value="8"/>
            <Setter Property="Background" Value="White"/>
            <Setter Property="BorderBrush" Value="#FFE0E0E0"/>
            <Setter Property="BorderThickness" Value="1"/>
        </Style>

        <Style x:Key="ModernButton" TargetType="Button">
            <Setter Property="Background" Value="#FF1976D2"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Height" Value="36"/>
            <Setter Property="MinWidth" Value="120"/>
            <Setter Property="Margin" Value="8,4,0,4"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Padding" Value="16,8"/>
        </Style>

        <Style x:Key="ModernTextBox" TargetType="TextBox">
            <Setter Property="Background" Value="White"/>
            <Setter Property="BorderBrush" Value="#FFE0E0E0"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="8"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="Margin" Value="8,4,8,4"/>
        </Style>

        <Style x:Key="ModernDecimalUpDown" TargetType="{x:Type xctk:DecimalUpDown}">
            <Setter Property="Height" Value="36"/>
            <Setter Property="Background" Value="White"/>
            <Setter Property="BorderBrush" Value="#FFE0E0E0"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Margin" Value="8,4,8,4"/>
        </Style>
    </Window.Resources>

    <Grid Margin="16">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- (1) FILTROS -->
        <GroupBox Header="Filtros" Style="{StaticResource ModernGroupBox}">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="250"/>
                    <!-- Nome -->
                    <ColumnDefinition Width="8"/>

                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="100"/>
                    <!-- Código -->
                    <ColumnDefinition Width="8"/>
                    <!-- Espaço reduzido -->
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="80"/>
                    <!-- Valor mín -->
                    <ColumnDefinition Width="8"/>
                    <!-- Espaço reduzido -->
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="80"/>
                    <!-- Valor máx -->
                    <ColumnDefinition Width="12"/>
                    <ColumnDefinition Width="Auto"/>
                    <!-- Botão Filtrar -->
                </Grid.ColumnDefinitions>

                <TextBlock Text="Nome:" VerticalAlignment="Center" Margin="8,0,8,0" FontWeight="SemiBold"/>
                <TextBox Grid.Column="1" Style="{StaticResource ModernTextBox}"
                 MaxLength="255" Height="35"
                 Text="{Binding FiltroNome, UpdateSourceTrigger=PropertyChanged}"/>

                <TextBlock Grid.Column="3" Text="Código:" VerticalAlignment="Center" Margin="8,0,8,0" FontWeight="SemiBold"/>
                <TextBox Grid.Column="4" Style="{StaticResource ModernTextBox}"
                 MaxLength="50" Height="35"
                 Text="{Binding FiltroCodigo, UpdateSourceTrigger=PropertyChanged}"/>

                <TextBlock Grid.Column="6" Text="Mín:" VerticalAlignment="Center" Margin="8,0,8,0" FontWeight="SemiBold"/>
                <xctk:DecimalUpDown Grid.Column="7" Style="{StaticResource ModernDecimalUpDown}"
                            Value="{Binding FiltroMin, UpdateSourceTrigger=PropertyChanged}" 
                            FormatString="F2" Minimum="0" Height="35"/>

                <TextBlock Grid.Column="9" Text="Máx:" VerticalAlignment="Center" Margin="8,0,8,0" FontWeight="SemiBold"/>
                <xctk:DecimalUpDown Grid.Column="10" Style="{StaticResource ModernDecimalUpDown}"
                            Value="{Binding FiltroMax, UpdateSourceTrigger=PropertyChanged}"
                            FormatString="F2" Minimum="0" Height="35"/>

                <Button Grid.Column="12" Command="{Binding FiltrarCmd}" Style="{StaticResource ModernButton}" MinWidth="100">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="🔍" FontSize="16" Margin="0,0,8,0"/>
                        <TextBlock Text="Filtrar" VerticalAlignment="Center"/>
                    </StackPanel>
                </Button>
            </Grid>
        </GroupBox>

        <!-- (2) LISTA -->
        <GroupBox Grid.Row="1" Header="Lista de Produtos" Style="{StaticResource ModernGroupBox}">
            <DataGrid ItemsSource="{Binding ProdutosCollection}"
                      SelectedItem="{Binding ProdutoSelecionado}"
                      AutoGenerateColumns="False"
                      IsReadOnly="True"
                      CanUserAddRows="False"
                      SelectionMode="Single"
                      Background="White"
                      BorderBrush="#FFE0E0E0"
                      BorderThickness="1">
                <DataGrid.Columns>
                    <DataGridTextColumn Header="Id" Binding="{Binding Id}" IsReadOnly="True" Width="60"/>
                    <DataGridTextColumn Header="Nome" Binding="{Binding Nome}" Width="*"/>
                    <DataGridTextColumn Header="Código" Binding="{Binding Codigo}" Width="150"/>
                    <DataGridTextColumn Header="Valor" Binding="{Binding Valor, StringFormat=\{0:C2\},ConverterCulture='pt-BR'}" Width="120"/>
                </DataGrid.Columns>
            </DataGrid>
        </GroupBox>

        <!-- (3) DETALHES + AÇÕES -->
        <GroupBox Grid.Row="2" Header="Detalhes do Produto Selecionado / Novo Cadastro" Style="{StaticResource ModernGroupBox}">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <!-- Formulário -->
                <Grid Grid.Row="0" Margin="0,0,0,16">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="300"/>
                        <ColumnDefinition Width="24"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="200"/>
                        <ColumnDefinition Width="24"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="140"/>
                    </Grid.ColumnDefinitions>

                    <TextBlock Text="Nome:" VerticalAlignment="Center" Margin="8,0,8,0" FontWeight="SemiBold"/>
                    <TextBox Grid.Column="1" Style="{StaticResource ModernTextBox}"
                             MaxLength="255" Height="35"
                             Text="{Binding ProdutoEdicao.Nome, UpdateSourceTrigger=PropertyChanged, ValidatesOnDataErrors=True}"
                             IsEnabled="{Binding IsCamposHabilitados}"/>

                    <TextBlock Grid.Column="3" Text="Código:" VerticalAlignment="Center" Margin="8,0,8,0" FontWeight="SemiBold"/>
                    <TextBox Grid.Column="4" Style="{StaticResource ModernTextBox}"
                             MaxLength="50" Height="35"
                             Text="{Binding ProdutoEdicao.Codigo, UpdateSourceTrigger=PropertyChanged, ValidatesOnDataErrors=True}"
                             IsEnabled="{Binding IsCamposHabilitados}"/>

                    <TextBlock Grid.Column="6" Text="Valor:" VerticalAlignment="Center" Margin="8,0,8,0" FontWeight="SemiBold"/>
                    <xctk:DecimalUpDown Grid.Column="7" Style="{StaticResource ModernDecimalUpDown}"
                                        Value="{Binding ProdutoEdicao.Valor, UpdateSourceTrigger=PropertyChanged}"
                                        FormatString="F2" Minimum="0" Height="35"
                                        IsEnabled="{Binding IsCamposHabilitados}"/>
                </Grid>

                <!-- Botões -->
                <WrapPanel Grid.Row="1" Orientation="Horizontal" Margin="0,8,0,0">
                    <Button Command="{Binding IncluirCmd}" Style="{StaticResource ModernButton}">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="➕" FontSize="16" Margin="0,0,8,0"/>
                            <TextBlock Text="Novo" VerticalAlignment="Center"/>
                        </StackPanel>
                    </Button>

                    <Button Command="{Binding SalvarCmd}" Style="{StaticResource ModernButton}" 
                            IsEnabled="{Binding IsCamposHabilitados}">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="💾" FontSize="16" Margin="0,0,8,0"/>
                            <TextBlock Text="Salvar" VerticalAlignment="Center"/>
                        </StackPanel>
                    </Button>

                    <Button Command="{Binding CancelarCmd}" Style="{StaticResource ModernButton}" 
                            IsEnabled="{Binding IsCamposHabilitados}" Background="#FF757575">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="❌" FontSize="16" Margin="0,0,8,0"/>
                            <TextBlock Text="Cancelar" VerticalAlignment="Center"/>
                        </StackPanel>
                    </Button>

                    <Button Command="{Binding ExcluirCmd}" Style="{StaticResource ModernButton}"
                            Background="#FFD32F2F">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="🗑️" FontSize="16" Margin="0,0,8,0"/>
                            <TextBlock Text="Excluir" VerticalAlignment="Center"/>
                        </StackPanel>
                    </Button>
                </WrapPanel>
            </Grid>
        </GroupBox>
    </Grid>
</Window>